!function(){function i(e){e.fn.fileDialog=function(){var a=this,i=this.cm,e=this.lang,t=this.editor,l=this.settings,n=(i.getCursor(),i.getSelection()),o=e.dialog.file,d=this.classPrefix,r=d+"file-dialog";i.focus();function f(e){c.find("."+d+"dialog-mask")[e?"show":"hide"]()}function s(e){if(e){if(f(!0),""===e.name)return alert(o.uploadFileEmpty),f(!1),!1;var t=new FormData;t.append("file",e);var i=l.uploadURL+(0<=l.uploadURL.indexOf("?")?"&":"?")+"&id="+a.id;$.ajax({type:"POST",url:i,data:t,cache:!1,contentType:!1,processData:!1,success:function(e){f(!1),1===e.success?c.find("[data-url]").val(e.url):alert(e.message)},complete:function(){f(!1)},error:function(e,t){f(!1)}})}}if(t.find("."+r).length<1){var c,u=(new Date).getTime(),p=(l.fileUpload?'<form class="'+d+'form">':'<div class="'+d+'form">')+"<label>"+o.url+'</label><input type="text" data-url />'+(l.fileUpload?'<div class="'+d+'file-input"><input type="file" name="'+d+'upload-file" /><input type="submit" value="'+o.uploadButton+'" /></div>':"")+"<br/><label>"+o.alt+'</label><input type="text" value="'+n+'" data-alt /><br/>'+(l.fileUpload?"</form>":"</div>");if((c=this.createDialog({title:o.title,width:l.fileUpload?465:380,height:214,name:r,content:p,mask:l.dialogShowMask,drag:l.dialogDraggable,lockScreen:l.dialogLockScreen,maskStyle:{opacity:l.dialogMaskOpacity,backgroundColor:l.dialogMaskBgColor},buttons:{enter:[e.buttons.enter,function(){var e=this.find("[data-url]").val(),t=this.find("[data-alt]").val();if(""===e)return alert(imageLang.imageURLEmpty),!1;return i.replaceSelection("["+(""===t?"附件描述":t)+"]("+e+")"),this.hide().lockScreen(!1).hideMask(),this.remove(),!1}],cancel:[e.buttons.cancel,function(){return this.hide().lockScreen(!1).hideMask(),this.remove(),!1}]}})).attr("id",d+"file-dialog-"+u),!l.fileUpload)return;var h=c.find('[name="'+d+'upload-file"]');h.bind("change",function(){return s(h[0].files[0])})}(c=t.find("."+r)).find('[type="text"]').val(""),c.find('[type="file"]').val(""),this.dialogShowMask(c),this.dialogLockScreen(),c.show(),0<a.uploadFile.length&&s(a.uploadFile.shift())}}"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?module.exports=i:"function"==typeof define?define.amd?define(["editormd"],function(e){i(e)}):define(function(e){var t=e("./../../editormd");i(t)}):i(window.editormd)}();